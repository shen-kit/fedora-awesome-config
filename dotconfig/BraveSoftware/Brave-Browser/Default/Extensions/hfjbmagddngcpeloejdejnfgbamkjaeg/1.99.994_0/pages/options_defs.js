"use strict";__filename="pages/options_defs.js",define(["require","exports","./async_bg","./options_base"],function(t,n,i,e){var r,u,s,o,h,f,a,c,l,v,d,p,m,g,b,_,N,x,y,M,k,w,O;Object.defineProperty(n,"__esModule",{value:true}),n.Mt=n.Tt=n.Vt=n.At=n.Et=n.Jt=n.jt=n.Ft=n.Rt=n.Ht=n.Bt=n.Dt=void 0,e.r.st=[],e.r.prototype.A=function(t){var n,r;t.call(this),VApi&&(n=e.u.L[this.T],r=this.Y(),(n in e.u.M?i.O(3,{key:n,val:r}):Promise.resolve(r)).then(function(t){if(VApi.z[n]=null!=t?t:r,"l"===n){var u=VApi.y().r;u&&u.querySelector("iframe.Omnibar")&&i.O(29,{key:n,val:null!=t?t:r})}e.r.ut&&e.r.ut()}))},e.r.prototype.D=function(t){var n,e;t.call(this),n=this.Y(),"autoReduceMotion"===this.T?(e=1===n||0!==n&&matchMedia("(prefers-reduced-motion: reduce)").matches,VApi&&(VApi.z.m=e),i.Lt(e)):this.F()},e.r.Ut=function(){return __awaiter(this,void 0,void 0,function*(){var t,n,r,u,s,o,h=e.r.rt,f=[];for(r in e.u.w(),n=(t=h.optionalPermissions)&&t.X(),yield Promise.all([e.u.N(),n]),h)!(u=h[r]).K&&u.it()&&f.push(u.qt());if(f.length>0&&!confirm(e.t("dirtyOptions",[f.join("\n  * ")])))return false;for(r in h)if(!(u=h[r]).K&&!u.W())return false;for(r in i.R(8),h.vimSync.K||(yield h.vimSync.X()),h.exclusionRules.K||(yield h.exclusionRules.X()),s=[],h)(o=h[r]).K||s.push(o.X());return yield Promise.all(s),i.R(0,8),true})},e.r.It=function(){var t,n=e.r.rt;for(t in n)if(!n[t].K)return true;return false},e.r.prototype.qt=function(){var t=this.j;return this instanceof u?t.nextElementSibling.textContent:(t=(t=t.closest("tr")).querySelector(".caption")).innerText.replace(/[\r\n]/g,"")},r=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.H=function(){var t,r,u=this;this.Q={min:(t=this.j.min)&&!isNaN(r=parseFloat(t))?r:null,max:(t=this.j.max)&&!isNaN(r=parseFloat(t))?r:null,default:0,U:n.zt},e.h(this.j,"input",this.E),e.h(this.j,"focus",this.Ct.bind(this)),i.V(function(){u.Q.default=e.u.S[u.T]})},n.prototype.G=function(t){this.j.value=""+t},n.prototype.Y=function(){return Math.round(parseFloat(this.j.value))},n.prototype.Ct=function(){var t=this,n=this.j,i=function(n){return t.Gt(n)},e=function(){n.removeEventListener("wheel",i,{passive:false}),n.removeEventListener("blur",e),t.Kt=0};this.Kt=0,n.addEventListener("wheel",i,{passive:false}),n.addEventListener("blur",e)},n.prototype.Gt=function(t){var n,e,r,u,s,o,h,f;if(i.Qt(t),n=this.Kt,!((e=Date.now())-n<100&&e+99>n&&n))return this.Kt=e,s=(r=this.j).value,"function"==typeof(h=(u=(t.deltaY||t.deltaX)>0)?r.stepUp:r.stepDown)?(h.call(r),o=r.value,r.value=s):(f=(h=parseFloat)(r.step)||1,e=(+r.value||0)+(u?f:-f),isNaN(f=h(r.max))||(e=Math.min(e,f)),isNaN(f=h(r.min))||(e=Math.max(e,f)),o=""+e),this.Wt(o,n>0,false)},n.zt=function(t){return isNaN(t)&&(t=this.default),t=null!=this.min?Math.max(this.min,t):t,null!=this.max?Math.min(this.max,t):t},n})(e.r),n.Dt=r,u=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.H=function(){var t=this.j,i=t.dataset.map;this.Xt=i?JSON.parse(i):t.dataset.allowNull?n.Yt:n.Zt,this.in=this.Xt.length-1,this.in>1&&"vimSync"!==this.T&&e.h(t,"input",this.onTripleStatusesClicked.bind(this),true),e.h(t,"change",this.E)},n.prototype.G=function(t){var n=true===t||t===this.Xt[this.in];this.j.checked=n,this.j.indeterminate=this.in>1&&t===this.Xt[1],this.sn=n?this.in:Math.max(0,this.Xt.indexOf(t))},n.prototype.Y=function(){return this.j.indeterminate?this.Xt[1]:this.Xt[this.j.checked?this.in:0]},n.prototype.onTripleStatusesClicked=function(t){this.sn=n.ToggleTripleStatuses(this.sn,t)},n.ToggleTripleStatuses=function(t,n){var e,r=n.target;return i.Qt(n),e=2===t?1:t?0:2,r.indeterminate=2===t,r.checked=2===e,e},n.prototype.I=function(t){return this.j.dataset.map&&"boolean"==typeof t&&(t=this.Xt[t?this.in:0]),t},n.on=function(t,n){t.disabled=n;var i=t.nextElementSibling;i.tabIndex=n?-1:0,n?i.setAttribute("aria-disabled","true"):i.removeAttribute("aria-disabled")},n.Zt=[false,true],n.Yt=[false,null,true],n})(e.r),n.Bt=u,s=(function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.hn=false,n}return __extends(n,t),n.prototype.H=function(){var t=this.j.dataset.converter||"",i=t?t.split(" "):[];e.h(this.j,"input",this.E),i.length>0&&(this.Q={fn:i,n:0,U:n.an})},n.prototype.Z=function(){var n=this,i=t.prototype.Z.call(this),e=this.Q;return e&&(e.n=0,i?i=i.then(function(){e.n=e.U(n.C)===n.C?1:0}):e.n=e.U(this.C)===this.C?1:0),i},n.prototype.G=function(t,n){var i=this.cn(t);true!==n?this.j.value=i:this.Wt(i,true,true)},n.prototype.ln=function(){return this.j.value.trim().replace(/\xa0/g," ")},n.prototype.cn=function(t){return t},n.prototype.Y=function(){var t=this.ln(),i=this.Q;return t&&i&&i.U===n.an&&(i.n|=2,t=n.an.call(i,t),i.n&=-3),t},n.prototype.nt=function(t){return this.cn(t)!==this.ln()},n.prototype.en=function(t,i){var e=!!t;(e||this.hn)&&(this.hn=e,n.en(t,i,this.j))},n.en=function(t,n,e){var r=!!t,u=e.classList,s=e.parentElement,o=e.nextElementSibling;o=o&&o.classList.contains("tip")?o:null,(r||o)&&i.V(function(){r?(null==o&&((o=document.createElement("div")).className="tip",s.insertBefore(o,e.nextElementSibling)),o.textContent=t,null!==n&&u.add(n||"has-error")):(u.remove("has-error"),u.remove("highlight"),o&&o.remove())})},n.an=function(t){var n,i,e=this.fn;if(e.indexOf("lower")>=0?t=t.toUpperCase().toLowerCase():e.indexOf("upper")>=0&&(t=t.toLowerCase().toUpperCase()),t=t.normalize(),e.indexOf("chars")<0||2&this.n&&!(1&this.n))return t;for(i of(n="",t.replace(/\s/g,"")))n.includes(i)||(n+=i);return n},n})(e.r),n.Ht=s,o=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.Y=function(){var n=t.prototype.Y.call(this);return n||this.G(n=e.u.S[this.T],true),n},n})(s),n.Rt=o,h=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.cn=function(t){var n=this.j instanceof HTMLInputElement,i=JSON.stringify(t,null,n?1:2);return n?i.replace(/(,?)\n\s*/g,function(t,n){return n?", ":""}):i},n.prototype.Y=function(){var n=t.prototype.Y.call(this),i=null;if(n)try{i=JSON.parse(n)}catch(t){}else this.G(i=e.u.S[this.T],true);return i},n.vn=function(t){var i,e;if(!t||"object"!=typeof t)return t;if(t instanceof Array)return t.map(n.vn);for(e of(i={},Object.keys(t).sort()))i[e]=n.vn(t[e]);return i},n.prototype.et=function(t,i){return JSON.stringify(t)===JSON.stringify(n.vn(i))},n.prototype.I=function(t){return n.vn(t)},n})(s),n.Ft=h,f=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.H=function(){t.prototype.H.call(this),this.dn=true,this.pn=this.mn.bind(this),e.h(this.j,"focus",this.pn)},n.prototype.mn=function(){this.pn&&(this.j.removeEventListener("focus",this.pn),this.j.classList.remove("masked"),this.pn=null,this.dn=false,this.j.removeAttribute("placeholder"),this.Z())},n.prototype.G=function(n,i){this.dn?this.j.placeholder=e.t("clickToUnmask"):t.prototype.G.call(this,n,i)},n.prototype.ln=function(){return this.dn?this.C:t.prototype.ln.call(this)},n})(s),n.jt=f,s.prototype.Wt=r.prototype.Wt=function(t,n,i){var e,r,u,s,o,h,f,a,c,l,v,d=this.j,p=d.value,m="backward"!==d.selectionDirection?d.selectionEnd:d.selectionStart,g=false;if(n&&(this.gn=true,(g=document.activeElement!==d)&&d.focus(),document.execCommand("undo")),this.gn=i,null==m)d.select(),document.execCommand("insertText",false,t),g&&this.j.blur();else{for(r=d.scrollLeft,u=d.scrollTop,s=0,o=(e=n?d.value:p).length-1,h=t.length-1,f=Math.min(o,h);s<=f&&e[s]===t[s];)s++;for(f=Math.max(s,o-(h-s));f<=o&&e[o]===t[h];)o--,h--;if(d.setSelectionRange(s,o+1),a=t.slice(s,h+1),document.execCommand("insertText",false,a),g&&d.blur(),p!==e){for(s=0,o=p.length-1,h=t.length-1,f=Math.min(o,h);s<=f&&p[s]===t[s];)s++;for(f=Math.max(s,o-(h-s));f<=o&&p[o]===t[h];)o--,h--}m?m===p.length?(r=d.scrollWidth,u=d.scrollHeight,m=t.length):m<s||(m>o?m+=h-o:(l=(c=p.slice(0,m).split("\n")).length,(v=t.split("\n").slice(0,l)).length===l&&(v[l-1]=v[l-1].slice(0,c[l-1].length)),m=v.reduce(function(t,n){return t+n.length},0)+v.length-1)):r=u=0,d.scrollTo(r,u),d.setSelectionRange(m,m)}this.gn=false},e.s.prototype.pt=function(t){var n,r,u,s,o;if(this.ht.length===t)for(u of(n=i.$("#exclusionToolbar"),r=i.$$("[data-model]",n),n.style.visibility=t?"":"hidden",r))(o=(s=e.r.rt[u.id]).j.parentNode.style).visibility=t||s.K?"":"visible",o.display=!t&&s.K?"none":""},n.Jt=i.$("#saveOptions"),n.Et=i.$("#exportButton"),n.Tt=(function(){var t,a,c,l,v=false;for(l of(n.At=function(t){return v=null!=t?t:v},t=function(){this.gn||((this.K=this.et(this.C,this.Y()))?v&&!e.r.It()&&(n.Jt.disabled=true,n.Jt.firstChild.data=e.t("115"),n.Et.disabled=false,n.At(false),window.onbeforeunload=null):v||(window.onbeforeunload=O,n.At(true),n.Jt.disabled=false,n.Jt.firstChild.data=e.t("115_2"),n.Et.disabled=true))},a={Number:r,Boolean:u,Text:s,NonEmptyText:o,JSON:h,MaskedText:f,ExclusionRules:e.s},c=function(n){var i=new(0,a[n.dataset.model])(n,t);return e.r.rt[i.T]=i},e.r.B=true,i.$$("[data-model]")))c(l);return n.Vt=function(t,n){a[t]=n},c})(),(c=(a=e.r.rt.exclusionRules).at).ondragstart=function(t){var n=t.target,e=document.activeElement;"input"!==e.localName?(a.bn=n,n.style.opacity="0.5"):e!==n&&i.Qt(t)},c.ondragend=function(){var t=a.bn;a.bn=null,t&&(t.style.opacity="")},c.ondragover=function(t){a.bn&&i.Qt(t)},c.ondrop=function(t){var n,e,r,u,s;i.Qt(t),(n=a.bn)&&(e=(e=t.target).closest(".exclusionRule"))&&n!==e&&(a.at.insertBefore(n,e),r=a.ht,u=n.querySelector(".pattern").vnode,s=e.querySelector(".pattern").vnode,r.splice(r.indexOf(u),1),r.splice(r.indexOf(s),0,u),a.E())},v=function(t){for(var n,i,e=new RegExp("^".concat("#").concat("!","[^\\n]*|^[^]"),"gm");n=e.exec(t);)if((i=n[0])&&"\n"!==i[0]){if("#"!==i[0])break;if("!"===i[1]&&"no-check"===i.slice(2).trim()){t=t.slice(0,n.index)+t.slice(n.index+i.length).trimLeft();break}}return t.replace(/\.activateMode(?:To)?/g,".activate")},(l=e.r.rt.keyMappings).q=function(){var t=e.r.prototype.q.call(this);return t instanceof Promise?t.then(v):v(t)},l.I=function(t){return t=v(t),e.r.prototype.I.call(this,t)},n.Mt=function(t){true===t?l.en(e.t("ignoredNonEN"),null):l.en(t)},m=e.r.rt.filterLinkHints,(d=e.r.rt.linkHintCharacters).F=(p=e.r.rt.linkHintNumbers).F=function(){this.en(!this.j.style.display&&this.C.length<4?"Too few characters for LinkHints":"")},m.F=function(){i.V(function(){var t=m.Y();p.j.style.display=t?"":"none",d.j.style.display=t?"none":"",u.on(e.r.rt.waitForEnter.j,!t),d.F(),p.F()})},e.h(m.j,"change",m.F,true),b=i.$$("input",(g=e.r.rt.keyLayout).j),_=b[0],N=b[1],x=b[2],y=b[3],M=b[4],g.Y=function(){var t,n=0;return _.checked?n=1:(n|=N.checked?8:0,n|=x.checked?2:x.indeterminate?4:0,n|=y.checked?16:y.indeterminate?512:0),n|=M.checked?128:M.indeterminate?64:0,256&(t=g.C)&&(-257&t)===n&&(n|=256),n},g.G=function(t){var n=!!(1&t);_.checked=n,N.checked=n||!!(8&t),x.checked=n||!!(2&t),x.indeterminate=!!(4&t),y.checked=n||!!(16&t),y.indeterminate=!!(512&t),M.checked=!!(128&t),M.indeterminate=!!(64&t),k=t,w(),e.r.ut&&i.O(3,{key:"l",val:t}).then(function(n){VApi.z.l=null!=n?n:t,e.r.ut&&e.r.ut()})},w=function(t){var n,e=_.checked;u.on(N,e),u.on(x,e),u.on(y,e),t&&(e?(N.checked=x.checked=y.checked=true,x.indeterminate=y.indeterminate=false):"number"!=typeof(n=g.q())||1&k||(k===n?g.Z():g.G(k),t.stopImmediatePropagation(),i.V(g.E)))},e.h(g.j,"input",function(t){var n,i,e,r=t.target;r===_?w(t):(i=r===x?2:r===y?16:r===M?128:8,(n=r===x?4:r===y?512:r===M?64:0)?(e=u.ToggleTripleStatuses(k&i?2:k&n?1:0,t),k=k&~(n|i)|(e>1?i:e?n:0)):k=k&~i|(r.checked?i:0))},true),e.r.rt.vomnibarPage.F=function(){var t=this.j,n=this.C,r=n.startsWith(location.protocol)||n.startsWith("front/");if(i.Pt<50)return i.V(function(){t.style.textDecoration=r?"":"line-through"}),this.en(n===e.u.S.vomnibarPage?"":e.t("onlyExtVomnibar",[50]),null);r?this.en(""):n.startsWith("file:")?this.en(e.t("fileVomnibar"),"highlight"):/^http:\/\/(?!localhost[:/])/i.test(n)?this.en(e.t("httpVomnibar"),"highlight"):this.en("")},e.r.rt.userDefinedCss.F=function(){var t=this;this.j.classList.contains("debugging")&&i.V(function(){var n,e,r,u=VApi.y().r;for(n of i.$$("iframe",u))e=n.classList.contains("HUD"),(r=n.contentDocument.querySelector("style.debugged"))&&(e?r.remove():r.classList.remove("debugged"));t.j.classList.remove("debugging")})},e.r.rt.autoReduceMotion.F=function(){var t=this;i.V(function(){var n=t.C;i.Lt(2===n?matchMedia("(prefers-reduced-motion: reduce)").matches:n>0)})},e.r.rt.passEsc.Y=function(){return o.prototype.Y.call(this).replace(/, /g,",")},e.r.rt.passEsc.cn=function(t){return t.replace(/,/g,", ")},O=function(){return setTimeout(function(){setTimeout(function(){var t,n;for(t of Object.values(e.r.rt))t instanceof s&&t.hn||(n="input"===(n=t.j).localName&&"checked"===n.type?n.parentElement:n).classList.toggle("highlight",!t.K)},300)},17),"Not saved yet"}});