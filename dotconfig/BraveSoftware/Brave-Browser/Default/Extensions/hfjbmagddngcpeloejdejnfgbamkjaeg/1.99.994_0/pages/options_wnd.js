"use strict";__filename="pages/options_wnd.js",define(["require","exports","./async_bg","./options_base","./options_defs","./options_permissions"],function(n,t,e,i,o,u){var c,r,a,f,s,l;Object.defineProperty(t,"__esModule",{value:true}),t.Vn=t.wn=t.clear_delayed_task=t.delayed_task=void 0,c=function(){t.delayed_task=null},t.clear_delayed_task=c,e.R(8),e.V(i.p),i.e&&e.V(i.e),e.V(function(n){n.textContent=u.yn.version_name||u.yn.version,parseInt(u.yn.version)>=2!=(3===u.yn.manifest_version)&&(n.parentElement.nextElementSibling.textContent="-mv"+u.yn.manifest_version)},e.$("#version")),i.h(o.Jt,"click",function(n){if(false===n){var t=i.r.st;i.r.st=[],o.Jt.disabled=true,o.Jt.firstChild.data=i.t("115_3"),o.Et.disabled=false,o.At(false),window.onbeforeunload=null,window.addEventListener("beforeunload",r,true),0!==t.length&&setTimeout(function(n){e.O(4,n.map(function(n){return i.u.L[n]}))},100,t)}else i.r.Ut().then(function(n){n&&o.Jt.onclick(false)})},"on"),r=function(){e.O(30)},a=function(){var n,o,c,r,a,f;for(n in i.r.B=false,i.r.rt)i.r.rt[n].Z();for(f of(i.r.rt.exclusionRules.C.length>0&&e.V(function(n){n.style.visibility=""},e.$("#exclusionToolbar")),document.addEventListener("keyup",s),i.h("[data-check]","input",function n(){for(var t of e.$$("[data-check]"))t.removeEventListener("input",n);e._n("./options_checker.js")}),i.h("[data-auto-resize]","click",function(n){var t,i,o=e.$("#"+n.target.dataset.autoResize),u=o.scrollHeight,c=o.scrollWidth,r=c-o.clientWidth;u<=o.clientHeight&&r<=0||(t=Math.max(Math.min(innerWidth,1024)-120,550),o.style.maxWidth=c>t?t+"px":"",o.style.height=o.style.width="",i=o.offsetHeight-o.clientHeight,u+=i=(r=c-o.clientWidth)>0?Math.max(26,i):i+18,r>0&&(o.style.width=o.offsetWidth+r+4+"px"),o.style.height=u+"px")}),i.h("[data-delay]","click",function(n){var i=this.dataset.delay,o=null;"event"===i&&(o=n||null),"continue"!==i&&n&&e.Qt(n),t.delayed_task=["#"+this.id,o],"complete"!==document.readyState?window.addEventListener("load",function n(t){t.target===document&&(window.removeEventListener("load",n),e._n("./options_ext.js"))}):e._n("./options_ext.js")},"on"),e.Pt<53&&i.h(".sel-all","mousedown",function(n){n.target===this&&(e.Qt(n),getSelection().selectAllChildren(this))}),(o=e.$$("[data-permission]")).length>0&&(function(n){function t(){var n,t=this.querySelector("[data-permission]");this.onclick=null,t&&(t.placeholder=i.t("lackPermission",[(n=t.dataset.permission)?': "'.concat(n,'"'):""]))}var o,c=u.yn.permissions||[],r=function(o){var r,a,f=n[o],s=f.dataset.permission;if("C"===s[0]){if(e.Pt>=parseInt(s.slice(1)))return"continue";if("."===(a=s.split(",",2)[1]||",")[0]?null!=window[a.slice(1)]:"("===a[0]&&matchMedia(a).matches)return"continue";r=["beforeChromium",[s.slice(1).split(",",1)[0]]]}else{if("mv3,nonFF"===s)return f.parentNode.parentNode.parentNode.style.display="none","continue";if("action"===s&&(s="browser_action"),s in u.yn||c.includes(s))return"continue";r=["lackPermission",[s?":\n* "+s:""]]}e.V(function(n){n.disabled=true;var e=i.t("invalidOption",[i.t(r[0],r[1])]);n instanceof HTMLInputElement&&"checkbox"===n.type?(n.nextElementSibling.tabIndex=-1,(n=n.parentElement).title=e):(n.value="",n.title=e,i.h(n.parentElement,"click",t,"on"),n instanceof HTMLSpanElement&&(n.style.textDecoration="line-through"))},f)};for(o=n.length;0<=--o;)r(o)})(o),i.h("[data-href]","mousedown",function(){var n,t;for(t of(document.onmouseover=null,n=function(n){n.onmousedown=null,e.O(10,[n.dataset.href,-1]).then(function(t){var e=t[0];n.removeAttribute("data-href"),n.href=e})},e.$$("[data-href]")))n(t)},"on"),document.onmouseover=function(){i.f("mousedown"),e.$("[data-href]").onmousedown()},c=e.$("#openExtensionsPage"),e.Pt<65?e.V(function(n){n.href="chrome://extensions/configureCommands"},c):e.Bn&&e.V(function(n){var t="edge://extensions/";n.href=t+"shortcuts",n.textContent=t+"\u2026"},c),e.V(function(n){var t=n.children[1],e=i.t("NewTabAdapter");t.title=e+" - "+i.t("webstore")},e.$("#chromeExtVomnibar")),r=function(n){var t,i,o;e.Qt(n),t=n.currentTarget.dataset.for.split(":").slice(-1)[0],o=((i=e.$$(t)).find(function(n){return n.checked})||i[0]).nextElementSibling,l(o,true,function(n){VApi&&VApi.x(n.parentElement.parentElement)})},a=function(n){var t=n.dataset.for,o=t.slice(t.indexOf(":")+1),u=t.split(":")[0],c=i.r.rt[u.replace("#","")],a=c.F,f=n.parentElement,s=function(){e.V(function(n){var t,o,u=n[0],c=n[1],r=n[2],a=r.find(function(n){return n.checked})||r[0];u.textContent=i.t(a.checked?"145_2":"144"),c&&(o=(t=a.nextElementSibling).getAttribute("data-i2"),c.textContent=o?e.y(o):t.textContent)},[f.querySelector(".status-of-related"),f.querySelector(".name-of-related"),o!==t?e.$$(o):[c.j]])};c.F=function(){return s(),a.call(c)},i.h(n,"click",r,"on"),i.h(c.j,"change",s,true)},e.$$(".ref-text")))a(f)},f=function(){var n,t,u,c,r;for(n in a(),a=f=null,e.Tn||e.V(function(n){n.textContent="Cmd"},e.$("#Ctrl")),i.r.rt)i.r.rt[n].F();e.V(function(){document.documentElement.classList.remove("loading")}),e.On.then(e.An),location.hash&&e.V(window.onhashchange),e.R(0,8),i.r.rt.keyMappings.F=function(){return e.O(7).then(o.Mt)},t=matchMedia("(prefers-color-scheme: dark)"),u=function(){c.K&&e.O(11),setTimeout(r,34)},r=function(){var n,i,o,u,r,a,f,s=c.Y(),l=2===s?!!t&&t.matches:1===s;if(VApi&&VApi.z){if(n=VApi.y().r)for(o of(i=n.firstElementChild&&"span"===n.firstElementChild.localName?n.firstElementChild:n,e.Pt<51?[].slice.call(i.children):i.children))"style"!==o.localName&&(o.classList.toggle("D",l),"iframe"===(o=o.firstElementChild||o).localName&&(u=o.classList.contains("Find"),(a=(r=o.contentDocument).querySelector("style#dark"))&&a.sheet&&(a.sheet.disabled=!l),r.body.classList.toggle(u?"D":"has-dark",l),u&&(f=VApi.y().f)&&f.parentElement.classList.toggle("D",l)));e.O(3,{key:"d",val:l}).then(function(n){VApi.z.d=n})}e.En(l?2===s?2:1:0)},(c=i.r.rt.autoDarkMode).F=u,e.Pt>75?e.V(function(){2===c.C&&e.On.then(u),t.onchange=u}):t=null,e.V(function(){setTimeout(function(){var n=document.createElement("script");n.src="loader.js",n.async=true,document.head.appendChild(n),document.documentElement.classList.add("smooth")},120)})},s=function(n){var t,u=n.target,c=n.keyCode;if(13===c)u instanceof HTMLAnchorElement?u.hasAttribute("href")||(setTimeout(function(n){e.Sn(n),n.blur()},0,u),e.Qt(n)):(n.ctrlKey||n.metaKey)&&(e.Qt(n),u.blur&&u.blur(),o.At()&&(i.f("click"),o.Jt.onclick()));else{if(32!==c)return;u instanceof HTMLSpanElement&&u.parentElement instanceof HTMLLabelElement&&(e.Qt(n),(t=u.parentElement.control).disabled||t.readOnly||e.Sn(t))}},i.h(i.r.rt.userDefinedCss.j,"input",i.v(function(){var n,t,o,u,c,r=i.r.rt.userDefinedCss,a=r.j.classList.contains("debugging");(!r.K||a)&&VApi&&VApi.z&&(n=r.Y(),t=n===r.C,o=e.O(8,[n,e.In]),u=VApi.y(),c=u.r,o.then(function(n){var e,o,u;r.j.classList.toggle("debugging",!t),VApi.t({k:c||t?0:1,t:i.t("livePreview")||"Live preview CSS\u2026",H:n.ui,f:n.find}),(o=(e=c&&c.querySelector("iframe.Omnibar"))&&e.contentDocument)&&((u=o.querySelector("style.debugged")||o.querySelector("style#custom"))||((u=o.createElement("style")).id="custom"),u.parentNode||o.head.appendChild(u),u.classList.add("debugged"),u.textContent=(t?"\n":"\n.inactive { opacity: 1; }\n")+(n.omni&&n.omni+"\n"||""))}))},1200,null,0)),t.wn=function(n){var t=e.Pt<63&&e.Pt>57&&!e.un.extension.getBackgroundPage;return t&&n&&e.O(32,{url:location.href.split("#")[0]+"#importButton",tabId:e.In}),t},i.h("#importButton","click",function(){var n=e.$("#importOptions");n.onchange?n.onchange(null):t.wn(1)||e.Sn(e.$("#settingsFile"))},"on"),e.V(function(n){var t,o,u,c,r=i.u.b,a=e.Mn,f=e.Pt;a||(u=(o=((t=navigator.userAgentData)&&(t.brands||t.uaList)||[]).filter(function(n){return(parseInt(n.version)===e.Pt&&"Chromium"!==n.brand||n.brand.includes("Opera"))&&!" ".concat(n.brand," ").includes(" Not ")})).find(function(n){return/\b(Edge|Opera)\b/.test(n.brand)})||o[0],c=e.Bn?"MS Edge":"",a=u?u.brand:t?c||"Chromium":(/\bChromium\b/.exec(navigator.userAgent)||[""])[0]||c||"Chrome",u&&(f=parseInt(u.version))),n.textContent=a+" "+f+("Chromium"===a?" based":"")+i.t("comma")+i.t("NS")+(i.t(r)||r[0].toUpperCase()+r.slice(1))},e.$("#browserName")),document.addEventListener("keydown",function(n){var t,i,o,u,c;if(e.Tn||!n.metaKey)if(32===n.keyCode)"span"===(c=n.target).localName&&"label"===c.parentElement.localName&&n.preventDefault();else{if(!VApi||!VApi.z||"input textarea".includes(document.activeElement.localName))return;"a-f12"===(t=VApi.r[3]({c:" ",e:n,i:n.keyCode,v:""},11))?(i=e.$("#importOptions"),o=i.selectedIndex,u=function(){i.onchange&&i.onchange(null),i.selectedIndex=o},e.$("#recommendedSettings").selected=true,null!=i.onchange?u():setTimeout(u,100)&&i.click()):"?"===t&&e.$("#showCommands").click()}else s(n)}),t.Vn=function(n){var t,o;if((n=n.slice("!"===n[1]?2:1))&&/^[a-z][\w-]*$/i.test(n))if(t=e.$('[data-hash="'.concat(n,'"]')))i.f("click"),t.onclick&&t.onclick(null,"hash");else if(t=e.Pt>=49?e.$('[id="'.concat(n.replace(/-/g,""),'" i]')):n.includes("-")&&e.$("#"+n.replace(/-[a-z]/gi,function(n){return n[1].toUpperCase()}))||e.$("#"+n)){if(t.dataset.model&&(t="input"===t.localName&&"checked"===t.type?t.parentElement:t).classList.add("highlight"),o=function(n){if(!n||n.target===window){window.onload&&(window.onload=null,Element.prototype.scrollBy?scrollTo({behavior:"instant",top:0,left:0}):scrollTo(0,0)),l(t);var i=t.localName;"button"!==i&&"a"!==i||e.Sn(t)}},"complete"===document.readyState)return o();window.scrollTo(0,0),window.onload=o}},window.onhashchange=function(){t.Vn(location.hash)},l=function(n,t,i){var o,u=-1;e.Pt<61?n.scrollIntoViewIfNeeded(true):n.scrollIntoView({block:t?"nearest":"center",behavior:"smooth"}),o=setInterval(function(){var t=scrollY;t===u&&(clearInterval(o),i&&i(n),n.focus()),u=t},72)},i.u.N().then(f),e.O(7).then(function(n){e.V(o.Mt,n)}),e.O(12).then(function(n){"?"!==n&&e.V(function(n){n[0].textContent=n[1]},[e.$("#questionShortcut"),n])}),i.h("#openExtensionsPage","click",function(n){e.Qt(n),e.O(15,{u:n.target.href,p:true})}),i.h(document,"click",function n(){var t=VApi,i=t&&t.y();i&&i.r&&(document.removeEventListener("click",n,true),i.r.addEventListener("click",function(n){var t,e=n.target;VApi&&e.classList.contains("HelpCommandName")&&(t=e.textContent.slice(1,-1),VApi.p({H:18,s:t}))},true),document.addEventListener("click",function(n){var t,i,o,u;"a"!==n.target.localName||!n.ctrlKey&&!n.metaKey||e.In<-1||(o=(i=(t=VApi)&&t.b)&&i.$())&&o.a&&o.k&&null===o.k.c&&(u=-17&o.m)<32&&2&u&&!(1&u)&&setTimeout(function(){e.In>=0&&(e.un.tabs?e.un.tabs.update(e.In,{active:true},function(){}):e.O(25,{module:"tabs",name:"update",args:[e.In,{active:true}]}))},0)}))},true),i.h("#testKeyInputBox","focus",function n(t){var o,u,c,r=t.currentTarget,a=e.$("#testKeyInput"),f=function(n,t){var e,i=void 0!==n?a.textContent=n:a.textContent;return n&&0!==t&&document.activeElement===a&&getSelection().setBaseAndExtent(e=a.firstChild,n.length,e,n.length),i},s=0,l=false;a.onkeydown=function(n){var t,i,c,r,d,m;if(l&&(l=false,a.classList.remove("outline")),229!==n.keyCode&&"Process"!==n.key){if(VApi&&!e.Hn(n)){if(t={c:" ",e:n,i:n.keyCode,v:""},c="esc"===(i=VApi.r[3](t,11))||"c-["===i,r=4&VApi.z.l?VApi.r[3](t,10):i,!i&&(16===t.i||"Shift"===n.key))return;if(d=i.length>1?"<".concat(i,">"):i||"(empty)",m=r===i?"":r.length>1?"<".concat(r,">"):r||"(empty)",o=n,u=VApi.z.l,f(m?"".concat(d," / ").concat(m):d),"enter"===i||"tab"===i||"s-tab"===i||c||"f12"===i)return void(("enter"===i||c)&&a.blur())}s=n.keyCode,e.Qt(n)}else f("")},a.onkeyup=function(n){n.keyCode===s&&e.Qt(n)},a.onfocus=function(){VApi&&(a.classList.add("outline"),l=true,VApi.f(7,Object.setPrototypeOf({i:true,r:0,k:"v-esc:test",p:true,h:a.previousElementSibling.textContent},null),1,0))},a.onblur=function(){VApi&&VApi.f(16,Object.setPrototypeOf({type:"keydown",key:"Esc",esc:true},null),1,0)},a.addEventListener("compositionend",function(){f("")}),a.onpaste=e.Qt,a.onclick=function(){a.focus()},(c=e.$("#testKeyInInput")).onchange=function(){c.checked?a.contentEditable="true":a.removeAttribute("contenteditable"),a.focus()},r.removeEventListener("focus",n,true),r.addEventListener("blur",function(n){var t=l?n.relatedTarget:null;(t?!r.contains(t):l)&&(l=false,a.classList.remove("outline"))},true),i.r.ut=function(){o&&u!==VApi.z.l&&a.onkeydown(o)}},true)});